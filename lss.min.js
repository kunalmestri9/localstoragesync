LocalStorageSync={ob:{mainDomain:"localhost.com",subdomains:["l.localhost.com","m.localhost.com"],isMainServerUpdationRequired:!1},isSyncNeeded:function(){var e=this.ob.subdomains.indexOf(document.domain);return document.domain==this.ob.mainDomain||-1!=e&&document.domain==this.ob.subdomains[e]},sendMessageToParent:function(e,o,t){var n={_key:e,_val:o,_domain:document.domain,_msgType:"_toAdd"};"undefined"!=typeof t&&(n._module=t),"undefined"==typeof o&&(n._msgType="_toremove"),document.getElementById("_ls_sync_mainDomain").contentWindow.postMessage(JSON.stringify(n),"*")},propagateMessageToChilds:function(e){for(var o=0;o<this.ob.subdomains.length;o++)e._domain!=this.ob.subdomains[o]&&document.getElementById("_ls_sync_"+this.ob.subdomains[o]).contentWindow.postMessage(JSON.stringify(e),"*")},_performOpOnLocal:function(e){"undefined"==typeof e._val?JSONStorage.removeStringWithoutPropagation(e._key):"undefined"!=typeof e._val&&"undefined"!=typeof e._module?JSONStorage.saveObjectToModuleWithoutPropagation(e._module,e._key,e._val):JSONStorage.setStringWithoutPropagation(e._key,e._val)},parentMessageRecived:function(e){LocalStorageSync.ob.isMainServerUpdationRequired&&this._performOpOnLocal(e),LocalStorageSync.propagateMessageToChilds(e)},childMessageRecived:function(e){this._performOpOnLocal(e)},init:function(){if(this.isSyncNeeded()){if(window.addEventListener("message",function(e){console.log("Message Recived By:"+document.domain);var o=JSON.parse(e.data);document.domain==LocalStorageSync.ob.mainDomain?LocalStorageSync.parentMessageRecived(o):LocalStorageSync.isSyncNeeded()&&LocalStorageSync.childMessageRecived(o)},!1),window.self!==window.top&&"_ls_sync_mainDomain"!=window.name)return void console.log("Returning");if(document.domain!=this.ob.mainDomain){var e=document.createElement("iframe");e.setAttribute("id","_ls_sync_mainDomain"),e.setAttribute("name","_ls_sync_mainDomain"),null!=document.body&&document.body.appendChild(e),e.setAttribute("src","http://"+this.ob.mainDomain+"/_blank.html")}else for(var o=0;o<this.ob.subdomains.length;o++){var e=document.createElement("iframe");e.setAttribute("id","_ls_sync_"+this.ob.subdomains[o]),e.setAttribute("name","_ls_sync_"+this.ob.subdomains[o]),null!=document.body&&document.body.appendChild(e),e.setAttribute("src","http://"+this.ob.subdomains[o]+"/_blank.html")}}}},StorageManager={insert:function(e,o){localStorage.setItem(e,JSON.stringify(o))},getObject:function(e){return localStorage.getItem(e)}},JSONStorage={saveObjectToModule:function(e,o,t){this.saveObjectToModuleWithoutPropagation(e,o,t),LocalStorageSync.isSyncNeeded()&&LocalStorageSync.sendMessageToParent(o,t,e)},saveObjectToModuleWithoutPropagation:function(e,o,t){var n=e+o;StorageManager.insert(n,t)},getObjectFromModule:function(e,o){var t=e+o;return JSON.parse(StorageManager.getObject(t))},setString:function(e,o){this.setStringWithoutPropagation(e,o),LocalStorageSync.isSyncNeeded()&&LocalStorageSync.sendMessageToParent(e,o)},setStringWithoutPropagation:function(e,o){localStorage.setItem(e,o)},getString:function(e){return localStorage.getItem(e)},removeString:function(e){return LocalStorageSync.isSyncNeeded()&&LocalStorageSync.sendMessageToParent(e),this.removeStringWithoutPropagation(e)},removeStringWithoutPropagation:function(e){return localStorage.removeItem(e)}},
